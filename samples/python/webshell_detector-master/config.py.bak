#!/usr/bin/env python

tencent_webshell_rule_jsp = (('str_pattern', 0, 1001, '\\bJFolder|\\bwebshell|\\bvonloesch\\.de|reDuh\\.jsp|QQ:179189585|JSP\\s*\xe9\x8f\x82\xe5\x9b\xa6\xe6\xac\xa2\xe7\xbb\xa0\xef\xbc\x84\xe6\x82\x8a\xe9\x8d\xa3\xe2\x96\x85\\bJSPSpy|\\bKJ021320', 0), ('exec_cmd', 1, 3001, '(?:(?:java\\.lang\\.)?Runtime)?\\s*(\\w+)\\s*=\\s*(?:java\\.lang\\.)?Runtime\\.getRuntime\\(\\)[\\s\\S]*\\1\\.exec\\(.*?\\)', 0), ('exec_cmd2', 1, 3002, 'new\\s*(java\\.io\\.)?ProcessBuilder\\(.*?\\)', 0), ('browse_file', 1, 5001, '(\\.(listFiles|list|listRoots)\\s*\\(.+\\.(readLine|read)\\s*\\(.+\\.write\\s*\\()|(\\.(readLine|read)\\s*\\(.+\\.write\\s*\\(.+\\.(listFiles|list|listRoots)\\s*\\()', 1), ('create_file', 0, 5002, 'new\\s*(java\\.io\\.)?(FileOutputStream|PrintWriter|FileWriter|RandomAccessFile)\\(.*?\\)', 0), ('upload_file', 0, 5003, 'new\\s*((java\\.io\\.)?ServletFileUpload|(com\\.jspsmart\\.upload\\.)?SmartUpload)\\(\\)', 0), ('net_socket', 0, 7001, 'new\\s*(java\\.net\\.)?ServerSocket\\(.*?\\)', 0), ('net_socket2', 0, 7002, 'new\\s*(java\\.net\\.)?Socket\\(.*?\\)', 0), ('net_socket3', 0, 7003, 'new\\s*(java\\.net\\.)?InetSocketAddress\\(.*?\\)', 0), ('http_connect', 0, 7004, '(\\w+)\\s*=\\s*new\\s*(java\\.net\\.)?URL\\(.*?\\)[\\s\\S]*\\1\\.openConnection\\(\\)', 0), ('java_command', 0, 12101, 'Runtime\\.getRuntime\\(\\)\\.exec', 0), ('java_unicode', 0, 12102, '(\\\\u00\\w\\w){3,}', 0), ('java_class_invoke', 0, 12103, '\\.getMethod\\(.*?\\.invoke', 0), ('java_class_invoke2', 0, 12104, '(?:(?:java\\.lang\\.reflect\\.)?Method)?\\s*(\\w+)\\s*=\\s*.*\\.getMethod\\([\\s\\S]*\\1\\.invoke\\(.*?\\)', 0), ('java_url_loader', 0, 12105, 'java\\.net\\.URLClassLoader', 0), ('sql_connect', 0, 12301, '(java\\.sql\\.)?DriverManager\\.(getConnection|registerDriver)\\(.*?\\)', 0), ('sql_query', 0, 12302, '(ResultSet)?\\s*\\w+\\s*=\\s*\\w+\\.executeQuery\\(.*?\\)', 0), ('jdbc_drivers', 0, 12303, 'COM\\.ibm\\.db2\\.jdbc\\.app\\.DB2Driver|COM\\.ibm\\.db2\\.jdbc\\.DB2XADataSource|COM\\.ibm\\.db2\\.jdbc\\.net\\.DB2Driver|com\\.informix\\.jdbc\\.IfxDriver|com\\.informix\\.jdbcx\\.IfxXADataSource|org\\.apache\\.derby\\.jdbc\\.ClientDriver|com\\.microsoft\\.sqlserver\\.jdbc\\.SQLServerDriver|com\\.microsoft\\.jdbc\\.sqlserver\\.SQLServerDriver|com\\.mysql\\.jdbc\\.Driver|org\\.gjt\\.mm\\.mysql\\.Driver|oracle\\.jdbc\\.driver\\.OracleDriver|oracle\\.jdbc\\.xa\\.client\\.OracleXADataSource|oracle\\.jdbc\\.driver\\.OracleDriver|oracle\\.jdbc\\.xa\\.client\\.OracleXADataSource|com\\.tongweb\\.jdbc\\.OracleDriverWrapper|org\\.postgresql\\.Driver|com\\.sybase\\.jdbc\\.SybDriver|com\\.sybase\\.jdbc2\\.jdbc\\.SybXADataSource|org\\.hsqldb\\.jdbcDriver|com\\.sybase\\.jdbc3\\.jdbc\\.SybDriver|com\\.kingbase\\.Driver|dm\\.jdbc\\.driver\\.DmDriver', 0))

tencent_webshell_rule_php = (('common_webshell1', 0, 10101, '(?i)[\\r\\n;/\\*]+\\s*\\b(include|require)(_once)?\\b[\\s\\(]*[\'"][^\\n\'"]{1,100}((\\.(jpg|png|txt|jpeg|log|tmp|db|cache)|\\_(tmp|log))|((http|https|file|php|data|ftp)\\://.{0,25}))[\'"][\\s\\)]*[\\r\\n;/\\*]+', 0), ('common_webshell2', 0, 10102, '(?i)(?<!->)\\b(assert|eval|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)\\b[/*\\s]*\\(+[/*\\s]*((\\$_(GET|POST|REQUEST|COOKIE).{0,25})|(base64_decode|gzinflate|gzuncompress|gzdecode|str_rot13)[\\s\\(]*(\\$_(GET|POST|REQUEST|COOKIE).{0,25}))', 0), ('common_webshell3', 0, 10103, '(?i)\\$\\s*(\\w+)\\s*=[\\s\\(\\{]*(\\$_(GET|POST|REQUEST|COOKIE).{0,25});[\\s\\S]{0,200}(?<!\\>)\\b(assert|eval|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)\\b[/*\\s]*\\(+[\\s"/*]*(\\$\\s*\\1|((base64_decode|gzinflate|gzuncompress|gzdecode|str_rot13)[\\s\\("]*\\$\\s*\\1))', 0), ('common_webshell4', 0, 10104, '(?i)(preg_replace|preg_filter)[/*\\s]*\\(+[/*\\s]*((\\$_(GET|POST|REQUEST|COOKIE).{0,25})|[^,]{0,250}chr[\\s\\(](101|0x65|0145|\\d+)[^,]{0,25}\\s*|[\'"]\\s*(([^\\s])[^,]{0,20}\\7[\'"]*|[\\(\\}\\[].{0,20}[\\(\\}\\]])\\w*e\\w*[\'"])\\s*,([^\\),]*(assert|eval|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)|((\\$_(GET|POST|REQUEST|COOKIE).{0,25})))', 0), ('common_webshell5', 0, 10105, '(?i)\\$\\s*(\\w+)\\s*=\\s*((\\$_(GET|POST|REQUEST|COOKIE).{0,25})|[^;]*chr[\\s\\(]*(101|0x65|0145|\\d+)|[\'"](/[^/]*/|\\|[^\\|]*\\||\\\\\'[^\']*\')\\w{0,5}e\\w{0,5}[\'"])[\\s\\S]{0,1000}(preg_replace|preg_filter)[/*\\s]*\\([/*\\s]*\\$\\s*\\1.{0,30}(assert|eval|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)', 0), ('common_webshell6', 0, 10106, '(?i)\\$\\s*(\\w+)\\s*=\\s*(\\$_(GET|POST|REQUEST|COOKIE).{0,25})[\\s\\S]{0,1000}(preg_replace|preg_filter)[/*\\s]*\\(+[/*\\s]*((\\$_(GET|POST|REQUEST|COOKIE).{0,25})|[^,]{0,250}chr[\\s\\(](101|0x65|0145|\\d+)[^,]{0,25}\\s*|[\'"]\\s*(([^\\s])[^,]{0,20}\\10|[\\(\\}\\[].{0,20}[\\(\\}\\]])\\w*e\\w*[\'"])\\s*,([^\\)]*(assert|eval|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)|\\s*\\$\\1)', 0), ('common_webshell7', 0, 10107, '(?i)(array_map|call_user_func|call_user_func_array|new\\s*ReflectionFunction|register_shutdown_function|register_tick_function|new\\s*ArrayObject[\\s\\S]*->u[ak]sort)\\s*\\(+\\s*([\'"]\\s*(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec|[^\'"]*\\\\x).{0,200}|(\\$_(GET|POST|REQUEST|COOKIE)\\[[^,;\\)]{0,250},[^;\\),]{0,50}\\$[^;\\),]{0,50}\\)))', 0), ('common_webshell8', 0, 10108, '(?i)\\$\\s*(\\w+)\\s*=[\\s\\(\\{]*((\\$_(GET|POST|REQUEST|COOKIE|SERVER).{0,25})|[\'"]\\s*(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec))[\\s\\S]{0,200}(?<!\\>)\\b(array_map|call_user_func|call_user_func_array|new\\s*ReflectionFunction|register_shutdown_function|register_tick_function|new\\s*ArrayObject[\\s\\S]*->u[ak]sort)\\b\\s*\\(+\\s*(\\$\\s*\\1|((base64_decode|gzinflate|gzuncompress|gzdecode|str_rot13)[\\s\\(]*\\$\\s*\\1))[^,;]*,[^;\\)]{0,50}\\$[^;\\)]{0,50}\\)', 0), ('common_webshell9', 0, 10109, '(?i)((array_filter|array_reduce|array_diff_ukey|array_udiff|array_walk|uasort|uksort|usort|new\\s*SQLite3[\\s\\S]*->\\s*createFunction)\\s*\\(+\\s*.{1,100}|PDO::FETCH_FUNC\\s*),\\s*([\'"]\\s*(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)\\s*[\'"]|(base64_decode|gzinflate|gzuncompress|gzdecode|str_rot13)[\\s\\(]+.{1,25}|(\\$_(GET|POST|REQUEST|COOKIE).{0,25}))\\s*\\)', 0), ('common_webshell10', 0, 10110, '(?i)\\$\\s*(\\w+)\\s*=[\\s\\(\\{]*((\\$_(GET|POST|REQUEST|COOKIE).{0,25})|[\'"]\\s*(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec|[^,;]*?\\\\x|[^,;]*?[\'"]\\s*\\.\\s*[\'"]))[\\s\\S]{0,1000}(?<!\\>)((array_filter|array_reduce|array_diff_ukey|array_udiff|array_walk|uasort|uksort|usort|new\\s*SQLite3[\\s\\S]*->\\s*createFunction)\\s*\\(+[^,]*\\$[^,]*|PDO::FETCH_FUNC\\s*),\\s*(\\$\\s*\\1\\s*\\)|((base64_decode|gzinflate|gzuncompress|gzdecode|str_rot13)[\\s\\(]*\\$\\s*\\1))', 0), ('common_webshell11', 0, 10111, '(?i)\\$(\\w*)\\s*=\\s*\\bcreate_function\\b\\s*\\(+\\s*[^;\\n\\r\\)]{1,100},\\s*([\'"]\\s*[^;\\n\\r\\)]{0,100}(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|poc_open|pcntl_exec).{1,600}\\s*[\'"]|[^,]{0,100}(\\$_(GET|POST|REQUEST|COOKIE|SERVER).{1,})|[^,\\n\\r\\)]{0,100}file_get_contents.{1,})\\s*\\)[\\s\\S]+\\$\\1\\s*\\([^\\)]*\\)', 0), ('common_webshell12', 0, 10112, '(?i)\\$(\\w*)\\s*=\\s*\\bcreate_function\\b\\s*\\([^;]*;[\\s\\S]*\\$\\1\\s*\\([^\\)]*([\'"]\\s*[^;\\n\\r\\)]{0,100}(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|poc_open|pcntl_exec).{1,600}\\s*[\'"]|[^;\\n\\r]{0,100}(\\$_(GET|POST|REQUEST|COOKIE|SERVER).{1,})|[^;\\n\\r\\)]{0,100}file_get_contents.{1,})', 0), ('common_webshell13', 0, 10113, '(?i)\\$\\s*(\\w+)\\s*=[\\s\\(\\{]*((\\$_(GET|POST|REQUEST|COOKIE|SERVER).{0,25})|[\'"]\\s*.{0,100}(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec).{1,100}\\s*[\'"]|file_get_contents)[\\s\\S]{0,200}create_function\\s*\\(+[^,]{1,100},[\'"\\s]*(\\$\\s*\\1[\'"\\s]*\\)|((base64_decode|gzinflate|gzuncompress|gzdecode|str_rot13)[\\s\\(]*\\$\\s*\\1))', 0), ('common_webshell14', 0, 10114, '(?i)\\$\\s*(\\w+)\\s*=\\s*((\\$_(GET|POST|REQUEST|COOKIE|SERVER).{0,25})|[\'"]\\s*(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)\\s*[\'"]|(base64_decode|gzinflate|gzuncompress|gzdecode|str_rot13)\\s*\\()[\\s\\S]{0,200}(?<![:>\\s])\\s*\\$\\1\\s*\\(+[^\\)]*(\\$_(GET|POST|REQUEST|COOKIE|SERVER).{0,25})', 0), ('common_webshell15', 0, 10115, '(?i)sqlite_create_function\\s*\\([\\s\\S]{0,200}(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)|(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)[\\s\\S]{0,200}sqlite_create_function\\s*\\(', 0), ('common_webshell25', 0, 10116, '(?i)\\b(filter_var|filter_var_array)\\b\\s*\\(.*FILTER_CALLBACK[^;]*((\\$_(GET|POST|REQUEST|COOKIE|SERVER).{0,25})|(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec))', 0), ('common_webshell16', 0, 10117, '(?i)\\$\\s*(\\w+)\\s*=\\s*((\\$_(GET|POST|REQUEST|COOKIE|SERVER).{0,25})|[\'"]\\s*(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)\\s*[\'"]|(base64_decode|gzinflate|gzuncompress|gzdecode|str_rot13)\\s*\\()[\\s\\S]{0,200}\\b(filter_var|filter_var_array)\\b\\s*\\(.*FILTER_CALLBACK[^;]*\\$\\1', 0), ('common_webshell17', 0, 10118, '(?i)\\b(mb_ereg_replace|mb_eregi_replace)\\b\\s*\\((.*,){3}\\s*([\'"][^,"\'\\)]*e[^,"\'\\)]*[\'"]|.*(\\$_(GET|POST|REQUEST|COOKIE|SERVER).{0,25}).*|chr\\s*\\(\\s*101|chr\\s*\\(\\s*0x65|chr\\s*\\(\\s*0145)\\s*\\)', 0), ('common_webshell25', 0, 10119, '(?i)\\$\\s*(\\w+)\\s*=\\s*((\\$_(GET|POST|REQUEST|COOKIE|SERVER).{3,25})|[\'"][^;]*e|[^;]*chr[\\s\\(]*(101|0x65|0145))[\\s\\S]{0,200}\\b(mb_ereg_replace|mb_eregi_replace)\\b\\s*\\((.*,){3}\\s*\\$\\1', 0), ('common_webshell18', 0, 10120, '(?i)array_walk(_recursive)?\\s*\\([^;,]*,\\s*([\'"]\\s*(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec|preg_replace)\\s*[\'"]|(\\$_(GET|POST|REQUEST|COOKIE|SERVER).{0,25}))', 0), ('common_webshell19', 0, 10121, '(?i)\\$\\s*(\\w+)\\s*=\\s*((\\$_(GET|POST|REQUEST|COOKIE|SERVER).{0,25})|[\'"]\\s*(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec|preg_replace))[\\s\\S]{0,200}array_walk(_recursive)?\\s*\\([^;,]*,\\s*(\\$\\s*\\1|((base64_decode|gzinflate|gzuncompress|gzdecode|str_rot13)[\\s\\(]*\\$\\s*\\1))', 0), ('common_webshell20', 0, 10122, '(?i)\\b(assert|eval|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec|include)\\b\\s*\\(\\s*(file_get_contents\\s*\\(\\s*)?[\'"]php://input', 0), ('common_webshell21', 0, 10123, '^(\\xff\\xd8|\\x89\\x50|GIF89a|GIF87a|BM|\\x00\\x00\\x01\\x00\\x01)[\\s\\S]*<\\?\\s*php', 0), ('common_webshell22', 0, 10124, "\\$(\\w)=\\$[a-zA-Z]\\('',\\$\\w\\);\\$\\1\\(\\);", 0), ('common_webshell23', 0, 10125, "(?i)\\$(\\w+)\\s*=\\s*str_replace\\s*\\([\\s\\S]*\\$(\\w+)\\s*=\\s*\\$(\\w+)(([\\s\\S]{0,255})|(\\s*\\(\\'\\',\\s*(\\$(\\w+)\\s*\\(\\s*)+))\\$\\1\\s*\\([\\s\\S]{0,100};?\\s*\\$\\2\\(?\\s*\\)", 0), ('common_webshell24', 0, 10126, '(?i)ob_start\\s*\\(+\\s*([\'"]\\s*(eval|assert|ass\\\\x65rt|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec).{0,20}|[\'"]\\s*\\w+[\\s\\S]{1,50}phpinfo\\s*\\(\\s*\\))', 0), ('common_webshell25', 0, 10127, '\\b(assert|eval|system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)\\b\\s*\\(((\\$_SERVER|\\$_ENV|getenv|\\$GLOBALS)\\s*[\\[\\(]\\s*[\'"]+(REQUEST_URI|QUERY_STRING|HTTP_[\\w_]+|REMOTE_[\\w_])[\'"\\s]+\\s*[\\]\\)]|php://input|exif_read_data\\s*\\()', 0), ('common_webshell24', 0, 10128, 'eval\\("\\?>"\\.|gzinflate\\(base64_decode\\(|eval\\(base64_decode\\(|cat\\s*/etc/passwd|Safe_Mode\\s*Bypass', 0), ('common_webshell25', 0, 10129, '\\$_\\[\\$_|\\${"_P"\\.|a(.)s\\1s\\1e\\1r\\1t|\'e\'\\.\'v\'\\.\'a\'\\.\'l|687474703a2f2f626c616b696e2e64756170702e636f6d2f7631|python_eval\\("import os\\\\nos.system\\(|\\$bind_pl\\s*=\\s*"IyEvdXNyL2Jpbi9lbnYgcGV|phpsocks5_encrypt\\s*\\(|eNrs/Vmv41iWJgq+ZwH1H7wdAWRksypJihRF3kQ0mvMsihTnuoUA53meeVG/valj5mbuHpF9b6P7se', 0), ('common_webshell25', 0, 10130, 'preg_replace\\s*\\(\\s*[\'"][^;]*e[^;]*[\'"],([^;]{0,30}\\\\x|[^;\\)]{200,300})|\\$back_connect="IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU2|define\\(\'gzip\',function_exists\\("ob_gzhandler"\\)|chr\\(112\\)\\.chr\\(97\\)\\.chr\\(115\\)\\.chr\\(115\\)|687474703a2f2f377368656c', 0), ('common_webshell24', 0, 10131, 'ini_get\\s*\\(\\s*"disable_functions"\\s*\\)|\\d\\s*=>\\s*array\\s*\\(\\s*[\'"]\\s*pipe\\s*[\'"]|gzuncompress\\(base64_decode\\(|crypt\\(\\$_SERVER\\[\'HTTP_H0ST\'\\],\\d+\\)==|if\\(file_exists\\(\\$settings\\[\'STOPFILE\'\\]\\)\\)', 0), ('common_webshell25', 0, 10132, '\\$nofuncs=\'no\\s*exec\\s*functions|udf\\.dll|\\$b374k|POWER-BY\\s*WWW.XXDDOS.COM|<title>Safes\\s*Mode\\s*Shell</title>|Siyanur\\.PHP\\s*</font>|c999shexit\\(\\)|\\$c99sh_|c99_sess_put\\(|Coded\\s*by\\s*cyb3r|cyb3r_getupdate\\(|coded\\s*by\\s*tjomi4|john\\.barker446@gmail\\.com|eval\\("\\\\\\$x=gzin"|eval\\("\\?>"\\.gzinflate\\(base64_decode\\(|eval\\(gzinflate\\(base64_decode\\(|eval\\(gzuncompress\\(base64_decode\\(|eval\\(gzinflate\\(str_rot13\\(base64_decode\\(|function_exists\\("zigetwar_buff_prepare"\\)|dQ99shell|r57shell|c99shell|lama\'s\'hell\\s*v|Carbylamine\\s*PHP\\s*Encoder|Safe\\s*Mode\\s*Shell|\\$dI3h=\\${\'_REQUEST\'};|new\\s*COM\\("IIS://localhost/w3svc"\\)|n57http-based\\[\\s*-\\]terminal|Dosya\\s*Olu|errorlog\\("BACKEND:\\s*startReDuh,|form\\s*name=sh311Form|PHPJackal<br>|Reddragonfly\'s\\s*WebShell|\\("system"==\\$seletefunc\\)\\?system\\(\\$shellcmd\\)|eNrsvGmT40iSKPZ5xmz|CrystalShell\\s*v\\.|Special\\s*99\\s*Shell|Simple\\s*PHP\\s*Mysql\\s*client|\'_de\'\\.\'code\'|phpsocks5_encrypt\\(|define\\(\'PHPSHELL_VERSION\',|ZXZhbCgkX1BPU1RbMV0p|\\$__H_H\\(\\$__C_C', 0), ('common_webshell25', 0, 10133, 'PD9waHANCiRzX3ZlciA9ICIxLjAiOw0KJHNfdGl0bGUgPSAiWG5vbnltb3V4IFNoZWxsIC|GFnyF4lgiGXW2N7BNyL5EEyQA42LdZtao2S9f|IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vYmFzaCAtaSI7|setcookie\\("N3tsh_surl"\\);|function\\s*Tihuan_Auto|\\$_COOKIE\\[\'b374k\'\\]|function_exists\\("k1r4_sess_put"\\)|http://www.7jyewu.cn/|scookie\\(\'phpspypass|PHVayv.php\\?duzkaydet=|phpRemoteView</a>|define\\(\'envlpass\',|KingDefacer_getupdate\\(|relative2absolute\\(|Host:\\s*old.zone-h.org|<h3>PHPKonsole</h3>|\\$_SESSION\\[\'hassubdirs\'\\]\\[\\$treeroot\\]|strtolower\\(\\$cmd\\)\\s*==\\s*"canirun"|\\$shell\\s*=\\s*\'uname\\s*-a;\\s*w;\\s*id;|Avrasya\\s*Veri\\s*ve\\s*NetWork|<h1>Linux Shells</h1>|\\$MyShellVersion\\s*=\\s*"MyShell|<a\\s*href="http://ihacklog.com/"|setcookie\\(\\s*"mysql_web_admin_username"\\s*\\)|<title>PHP\\s*Shell\\s*[^\\n\\r]*</title>|\\$OOO000000=urldecode|1MSSYowqjzlVVAwAoHHFXzQ5Lc|\'xiaoqiwangluo\'|EqQC1FhyXxpEi7l2g\\+yNjW62S|\\$_uU\\(83\\)\\.\\$_uU\\(84\\)|7kyJ7kSKioDTWVWeRB3TiciL1UjcmRiLn4SKiAETs90cuZlTz5mROtHWHdWfRt0ZupmVRNTU2Y2MVZkT8|<title>\\s*ARS\\s*Terminator\\s*Shell</title>|base64_decode\\("R0lGODdhEgASAKEAAO7u7gAAAJmZmQAAACwAAA|\\\\x50\\\\x4b\\\\x03\\\\x04\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00|\'<title>W3D\\s*Shell|\\$back_connect="IyEvdXNyL2Jpbi9wZXJsD', 0), ('common_webshell30', 0, 10135, '\\$(\\w+)[\\s]*\\=[\\s]*\\$_(?:POST|GET|REQUEST|COOKIE|SERVER).{0,25}[\\s\\S]*(?<!\\>)\\$(?:\\1\\(\\s*\\$_(?:POST|GET|REQUEST|COOKIE|SERVER).{0,25}\\s*\\)|(\\w+)\\s*\\=\\s*\\$_(?:POST|GET|REQUEST|COOKIE|SERVER).{0,25}[\\s\\S]*(?<!\\>)\\$(\\1\\(\\s*\\$\\2|\\2\\(\\s*\\$\\1)\\s*\\)|_(?:POST|GET|REQUEST|COOKIE|SERVER).{0,25}\\(\\s*\\$\\1\\s*\\))|\\$_(?:POST|GET|REQUEST|COOKIE|SERVER)\\[([\'"]\\w+[\'"]|\\d+)\\]\\(\\s*\\$_(?:POST|GET|REQUEST|COOKIE|SERVER)\\[([\'"]\\w+[\'"]|\\d+)\\]\\s*\\)', 0))
ali_webshell_rule_jsp = [[{'data': u'String\\s*(\\w+?);[\\s\\S]*String\\s*(\\w+?);[\\s\\S]*String\\s*(.*?);[\\s\\S]*\\1[\\s\\S]*\\2[\\s\\S]*java\n\n\\.net\\.HttpURLConnection(.*?)openConnection[\\s\\S]*\\2\\s*\\+=\\s*\\1[\\s\\S]*out\\.println\\(\\s*\\2\\s*\\)', 'type': u'1'}], [{'data': u'allowTypes=newString[]{"jpg","jpeg","gif","ico","bmp","png"}\n\n', 'type': u'2'}, {'data': u'Util.null2String(request.getParameter("dir"));', 'type': u'2'}, {'data': u'saveFile.substring(0,saveFile.indexOf(', 'type': u'2'}, {'data': u'newFileOutputStream(fileName);', 'type': u'2'}], [{'data': u'request.getRequestURI(', 'type': u'2'}, {'data': u'.getBytes(', 'type': u'2'}, {'data': u'.getServletContext().getRealPath(', 'type': u'2'}, {'data': u'FileReader(', 'type': u'2'}, {'data': u'FileWriter(', 'type': u'2'}, {'data': u'.replaceAll(', 'type': u'2'}, {'data': u'.queryHashtable(', 'type': u'2'}, {'data': u'.listFiles(', 'type': u'2'}, {'data': u'.getFilePointer(', 'type': u'2'}, {'data': u'.delete(', 'type': u'2'}, {'data': u'RandomAccessFile(', 'type': u'2'}, {'data': u'System.out.println(', 'type': u'2'}], [{'data': u'HttpServletRequest', 'type': u'2'}, {'data': u'.getBytes(REQUEST_CHARSET)', 'type': u'2'}, {'data': u'.getConnection(', 'type': u'2'}, {'data': u'.isClosed(', 'type': u'2'}, {'data': u'.url.equals(', 'type': u'2'}, {'data': u'InputStreamReader(', 'type': u'2'}, {'data': u'OutputStreamWriter(', 'type': u'2'}, {'data': u'.write(', 'type': u'2'}, {'data': u'.flush(', 'type': u'2'}, {'data': u'.toLowerCase().endsWith(', 'type': u'2'}, {'data': u'JarFile(', 'type': u'2'}, {'data': u'ZipFile(', 'type': u'2'}, {'data': u'EnterFile(', 'type': u'2'}, {'data': u'.setAbsolutePath(', 'type': u'2'}, {'data': u'.getMetaData(', 'type': u'2'}, {'data': u'.getColumnName(', 'type': u'2'}, {'data': u'formatNumber(', 'type': u'2'}, {'data': u'.getInterfaces().length', 'type': u'2'}, {'data': u'response.getOutputStream(', 'type': u'2'}], [{'data': u'response.setCharacterEncoding(', 'type': u'2'}, {'data': u'StringBuffer(', 'type': u'2'}, {'data': u'request.getParameter(', 'type': u'2'}, {'data': u'request.getSession().getServletContext().getRealPath("/")\n\n', 'type': u'2'}, {'data': u'.equals(', 'type': u'2'}, {'data': u'.append(', 'type': u'2'}, {'data': u'.substring(', 'type': u'2'}, {'data': u'BufferedReader(', 'type': u'2'}, {'data': u'InputStreamReader(', 'type': u'2'}, {'data': u'FileInputStream(newFile(', 'type': u'2'}, {'data': u'.replaceAll("\\\\","/")', 'type': u'2'}, {'data': u'.toString()', 'type': u'2'}], [{'data': u'HttpServletRequestWrapper', 'type': u'2'}, {'data': u'.getParameter(', 'type': u'2'}, {'data': u'.getBytes(REQUEST_CHARSET)', 'type': u'2'}, {'data': u'=DriverManager.getConnection(', 'type': u'2'}, {'data': u'.createStatement(', 'type': u'2'}, {'data': u'.execute(', 'type': u'2'}, {'data': u'.getResultSet(', 'type': u'2'}, {'data': u'.getUpdateCount(', 'type': u'2'}, {'data': u'BufferedReader(', 'type': u'2'}, {'data': u'InputStreamReader(', 'type': u'2'}, {'data': u'.name.equals(', 'type': u'2'}, {'data': u'.replace(', 'type': u'2'}, {'data': u'.getCmd().equals(', 'type': u'2'}, {'data': u'.write(', 'type': u'2'}, {'data': u'.ol.setCmd(', 'type': u'2'}, {'data': u'.htmlEncode(', 'type': u'2'}, {'data': u'formatNumber(', 'type': u'2'}, {'data': u'.setMaximumFractionDigits(', 'type': u'2'}, {'data': u'.getInstance(', 'type': u'2'}, {'data': u'.readLine(', 'type': u'2'}], [{'data': u').newInstance(', 'type': u'2'}, {'data': u'DriverManager.getConnection(', 'type': u'2'}, {'data': u'.setCatalog(', 'type': u'2'}, {'data': u'File.listRoots(', 'type': u'2'}, {'data': u'.listFiles(', 'type': u'2'}, {'data': u'.lastModified(', 'type': u'2'}, {'data': u'.isDirectory(', 'type': u'2'}, {'data': u'.getName(', 'type': u'2'}, {'data': u'.append(', 'type': u'2'}, {'data': u'.delete(', 'type': u'2'}, {'data': u'.getOutputStream(', 'type': u'2'}, {'data': u'FileInputStream(', 'type': u'2'}, {'data': u'.createNewFile(', 'type': u'2'}, {'data': u'SimpleDateFormat(', 'type': u'2'}, {'data': u'(HttpURLConnection)', 'type': u'2'}, {'data': u'.getMetaData().getTables(', 'type': u'2'}, {'data': u'.createStatement(', 'type': u'2'}, {'data': u'.executeQuery(', 'type': u'2'}, {'data': u'Runtime.getRuntime().exec(', 'type': u'2'}, {'data': u'.getInputStream(', 'type': u'2'}], [{'data': u'DateFormat.getDateTimeInstance()', 'type': u'2'}, {'data': u'System.currentTimeMillis()', 'type': u'2'}, {'data': u'convertFileSize(', 'type': u'2'}, {'data': u'System.arraycopy(', 'type': u'2'}, {'data': u'newHashtable(', 'type': u'2'}, {'data': u'System.getProperty(', 'type': u'2'}, {'data': u'IllegalArgumentException', 'type': u'2'}, {'data': u'.startsWith(', 'type': u'2'}, {'data': u'IllegalArgumentException(', 'type': u'2'}, {'data': u'.nextToken(', 'type': u'2'}, {'data': u'.nextToken().trim().equalsIgnoreCase(', 'type': u'2'}, {'data': u'FileOutputStream(', 'type': u'2'}, {'data': u'.separatorChar', 'type': u'2'}, {'data': u'URLDecoder.decode(', 'type': u'2'}, {'data': u'.append(conv2Html(', 'type': u'2'}, {'data': u'.getCanonicalPath().startsWith(', 'type': u'2'}, {'data': u'.getAbsolutePath()', 'type': u'2'}, {'data': u'.getParameterValues(', 'type': u'2'}, {'data': u'.getAbsolutePath(', 'type': u'2'}, {'data': u'FileOutputStream(', 'type': u'2'}, {'data': u'GZIPInputStream(', 'type': u'2'}, {'data': u'application.getRealPath(request.getRequestURI())).getParent\n\n()', 'type': u'2'}], [{'data': u'isNotEmpty(getSystemEncoding())', 'type': u'2'}, {'data': u'.printStackTrace(newPrintWriter(', 'type': u'2'}, {'data': u'getSystemEncoding(', 'type': u'2'}, {'data': u'ByteArrayOutputStream(', 'type': u'2'}, {'data': u'.delete()', 'type': u'2'}, {'data': u'exec(', 'type': u'2'}, {'data': u'isNotEmpty(request.getParameter(', 'type': u'2'}, {'data': u'.getBytes(', 'type': u'2'}, {'data': u'BufferedOutputStream(response.getOutputStream())\n\n', 'type': u'2'}, {'data': u'.pushBody()', 'type': u'2'}], [{'data': u'Class.forName(', 'type': u'2'}, {'data': u'DriverManager.getConnection(', 'type': u'2'}, {'data': u'SimpleDateFormat(', 'type': u'2'}, {'data': u'.isDirectory(', 'type': u'2'}, {'data': u'HttpServletResponse', 'type': u'2'}, {'data': u'BufferedInputStream(newFileInputStream(', 'type': u'2'}, {'data': u'File(', 'type': u'2'}, {'data': u'.mkdir(', 'type': u'2'}, {'data': u'.listFiles(', 'type': u'2'}, {'data': u'.setLastModified(', 'type': u'2'}, {'data': u'File(application.getRealPath(request.getRequestURI\n\n())).getParent()', 'type': u'2'}, {'data': u'.getErrorStream(', 'type': u'2'}], [{'data': u'Runtime.getRuntime()', 'type': u'2'}, {'data': u'InputStreamReader(', 'type': u'2'}, {'data': u'Charset.forName(', 'type': u'2'}, {'data': u'File(', 'type': u'2'}, {'data': u'getParent(', 'type': u'2'}, {'data': u'.isDirectory(', 'type': u'2'}, {'data': u'.list()', 'type': u'2'}, {'data': u'.lastIndexOf(', 'type': u'2'}, {'data': u'.substring(', 'type': u'2'}, {'data': u'.write(', 'type': u'2'}, {'data': u'.isDirectory(', 'type': u'2'}, {'data': u'[request.getContentLength()]', 'type': u'2'}, {'data': u'JshellConfigException', 'type': u'2'}, {'data': u'(String)session.getAttribute(', 'type': u'2'}, {'data': u'session.removeAttribute(', 'type': u'2'}, {'data': u'response.sendRedirect(request.getRequestURI())', 'type': u'2'}, {'data': u'System.getProperty(', 'type': u'2'}, {'data': u'request.getRealPath(request.getServletPath())', 'type': u'2'}], [{'data': u'initPageData(request,session);', 'type': u'2'}, {'data': u'if(request.getParameter(', 'type': u'2'}, {'data': u'DataBaseType.equalsIgnoreCase(', 'type': u'2'}, {'data': u'DriverManager.getConnection(', 'type': u'2'}, {'data': u'.prepareStatement(', 'type': u'2'}, {'data': u'.printStackTrace()', 'type': u'2'}, {'data': u'session.setAttribute(', 'type': u'2'}, {'data': u'.equals(request.getParameter(', 'type': u'2'}, {'data': u'setConnection(request,session);', 'type': u'2'}, {'data': u'executQuery(connection,SHOWDATEBASES);', 'type': u'2'}, {'data': u'(HttpServletRequest', 'type': u'2'}, {'data': u'executQuery(', 'type': u'2'}, {'data': u'.getColumnName(', 'type': u'2'}, {'data': u'.getMetaData(', 'type': u'2'}, {'data': u'session.setAttribute(', 'type': u'2'}], [{'data': u'IllegalArgumentException(', 'type': u'2'}, {'data': u'boundary.trim().length()', 'type': u'2'}, {'data': u'Hashtable(', 'type': u'2'}, {'data': u'StringTokenizer(', 'type': u'2'}, {'data': u'.nextToken(', 'type': u'2'}, {'data': u'.lastIndexOf(', 'type': u'2'}, {'data': u'.isDirectory(', 'type': u'2'}, {'data': u'ZipEntry(', 'type': u'2'}, {'data': u'BufferedInputStream(newFileInputStream(', 'type': u'2'}, {'data': u'.getAbsolutePath()=conv2Html(', 'type': u'2'}, {'data': u'response.setContentType(', 'type': u'2'}, {'data': u'conv2Html(request.getParameter(', 'type': u'2'}, {'data': u'.getName(', 'type': u'2'}, {'data': u').createNewFile(', 'type': u'2'}], [{'data': u'File(', 'type': u'2'}, {'data': u'PrintWriter(', 'type': u'2'}, {'data': u'.println(', 'type': u'2'}, {'data': u'.exists(', 'type': u'2'}, {'data': u'.length(', 'type': u'2'}, {'data': u'request.getRequestURI()', 'type': u'2'}, {'data': u'response.sendRedirect(', 'type': u'2'}, {'data': u'request.getRealPath(request.getServletPath())', 'type': u'2'}], [{'data': u'extendsJPanelimplementsRunnable', 'type': u'2'}, {'data': u'JScrollPanescrollPane', 'type': u'2'}, {'data': u'Color(', 'type': u'2'}, {'data': u'.getSystemState(', 'type': u'2'}, {'data': u'PySystemState', 'type': u'2'}, {'data': u'BorderLayout()', 'type': u'2'}, {'data': u'Java2DTextWindow(', 'type': u'2'}, {'data': u'.setBackground(', 'type': u'2'}, {'data': u'.setViewportView(', 'type': u'2'}, {'data': u'DefaultConsoleImpl(', 'type': u'2'}, {'data': u'.setTextAttributes(', 'type': u'2'}, {'data': u'TextAttributes(', 'type': u'2'}, {'data': u'setTextAttributes(', 'type': u'2'}, {'data': u'.printStackTrace()', 'type': u'2'}, {'data': u'PySystemState.initialize(System.getProperties()', 'type': u'2'}], [{'data': u'Hashtable()', 'type': u'2'}, {'data': u'.put(', 'type': u'2'}, {'data': u'System.currentTimeMillis();', 'type': u'2'}, {'data': u'convertFileSize(', 'type': u'2'}, {'data': u'System.arraycopy(', 'type': u'2'}, {'data': u'System.getProperty(', 'type': u'2'}, {'data': u'IllegalArgumentException', 'type': u'2'}, {'data': u'StringTokenizer(', 'type': u'2'}, {'data': u'.countTokens(', 'type': u'2'}, {'data': u'.nextToken(', 'type': u'2'}, {'data': u'.nextToken().trim().equalsIgnoreCase(', 'type': u'2'}], [{'data': u'System.currentTimeMillis()', 'type': u'2'}, {'data': u'System.getProperties();', 'type': u'2'}, {'data': u'.hasMoreElements(', 'type': u'2'}, {'data': u'.indexOf(', 'type': u'2'}, {'data': u'.put(', 'type': u'2'}, {'data': u'Random().nextInt(', 'type': u'2'}, {'data': u'request.getQueryString().indexOf(', 'type': u'2'}, {'data': u'(float)Runtime.getRuntime().freeMemory()', 'type': u'2'}, {'data': u'(float)Runtime.getRuntime().totalMemory()', 'type': u'2'}, {'data': u'.htShowMsg.get(', 'type': u'2'}, {'data': u'.htShowMsg.get(', 'type': u'2'}], [{'data': u'StreamConnectorextendsThread', 'type': u'2'}, {'data': u'OutputStream', 'type': u'2'}, {'data': u'BufferedReader(newInputStreamReader(', 'type': u'2'}, {'data': u'.read(', 'type': u'2'}, {'data': u'.write(', 'type': u'2'}, {'data': u'.flush()', 'type': u'2'}, {'data': u'.start()', 'type': u'2'}, {'data': u'.getInputStream()', 'type': u'2'}, {'data': u'request.getParameter(', 'type': u'2'}, {'data': u'Socket(', 'type': u'2'}], [{'data': u'convertpath(application.getrealpath(""));', 'type': u'2'}, {'data': u'application.getrealpath(request.getrequesturi())\n\n', 'type': u'2'}, {'data': u'.getParent();session.setMaxInactiveInterval()', 'type': u'2'}, {'data': u'StringencodeGbUnicode(', 'type': u'2'}, {'data': u'newFile(', 'type': u'2'}, {'data': u'.isHidden()', 'type': u'2'}, {'data': u'newSimpleDateFormat(', 'type': u'2'}, {'data': u'out.print("");out.print("");out.print("");out.print\n\n("");out.print("");out.print("");', 'type': u'2'}], [{'data': u'.getBytes(REQUEST_CHARSET),PAGE_CHARSET);', 'type': u'2'}, {'data': u'DriverManager.getConnection', 'type': u'2'}, {'data': u'DriverManager.getConnection(', 'type': u'2'}, {'data': u'.getUpdateCount()', 'type': u'2'}, {'data': u'newBufferedReader(newInputStreamReader', 'type': u'2'}, {'data': u'SHELL_NAME=request.getServletPath();', 'type': u'2'}], [{'data': u'request.getRequestURI()', 'type': u'2'}, {'data': u'.getServletContext().getRealPath(', 'type': u'2'}, {'data': u'newPrintWriter(', 'type': u'2'}, {'data': u'System.out.println(', 'type': u'2'}, {'data': u'.hasMoreElements()', 'type': u'2'}, {'data': u'(float)Runtime.getRuntime().totalMemory()', 'type': u'2'}], [{'data': u'newFile(request.getParameter(""))', 'type': u'2'}, {'data': u'.isDirectory()', 'type': u'2'}, {'data': u'.listFiles();for(', 'type': u'2'}, {'data': u'.isDirectory(', 'type': u'2'}, {'data': u'[].canRead()==true', 'type': u'2'}, {'data': u'response.getOutputStream()', 'type': u'2'}, {'data': u'.read();', 'type': u'2'}, {'data': u'.printStackTrace(', 'type': u'2'}], [{'data': u'request.getParameter("")', 'type': u'2'}, {'data': u'=request.getRealPath(request.getServletPath())', 'type': u'2'}, {'data': u'newFile(', 'type': u'2'}, {'data': u'newPrintWriter(', 'type': u'2'}, {'data': u'.length()>', 'type': u'2'}, {'data': u'out.println("");out.println("");out.println("")', 'type': u'2'}], [{'data': u'if(request.getParameter("")=null)', 'type': u'2'}, {'data': u'newString(request.getParameter("").getBytes\n\n(""),"");', 'type': u'2'}, {'data': u'newFileOutputStream(', 'type': u'2'}, {'data': u'request.getServerName()', 'type': u'2'}, {'data': u'.print(request.getRealPath(request.getServletPath()))\n\n', 'type': u'2'}], [{'data': u'folderReplace(application.getRealPath(""));', 'type': u'2'}, {'data': u'request.getRequestURI();if(session.getAttribute("")==null)\n\n', 'type': u'2'}, {'data': u'response.sendRedirect(URL)', 'type': u'2'}, {'data': u'out.print("");out.print("");out.print("")', 'type': u'2'}, {'data': u'.lookInfo()', 'type': u'2'}, {'data': u'DriverManager.getConnection', 'type': u'2'}], [{'data': u'Class.forName(', 'type': u'2'}, {'data': u'=DriverManager.getConnection(', 'type': u'2'}, {'data': u'.getMetaData();', 'type': u'2'}, {'data': u'newArrayList<String>();', 'type': u'2'}, {'data': u'.createStatement();for(', 'type': u'2'}, {'data': u'newOutputStreamWriter(newFileOutputStream(', 'type': u'2'}, {'data': u'.getColumnCount()', 'type': u'2'}, {'data': u'.setStatus();', 'type': u'2'}], [{'data': u'DriverManager.getConnection', 'type': u'2'}, {'data': u'.createStatement(', 'type': u'2'}, {'data': u'.executeQuery(', 'type': u'2'}, {'data': u'.getMetaData(', 'type': u'2'}, {'data': u'response.setStatus()', 'type': u'2'}, {'data': u'newOutputStreamWriter(newFileOutputStream(', 'type': u'2'}], [{'data': u'DriverManager.getConnection', 'type': u'2'}, {'data': u'.prepareStatement(', 'type': u'2'}, {'data': u'.executeQuery(', 'type': u'2'}, {'data': u'ArrayList<String>', 'type': u'2'}, {'data': u'newArrayList<String>();while(rs.next())', 'type': u'2'}, {'data': u'newOutputStreamWriter(newFileOutputStream(', 'type': u'2'}, {'data': u'.prepareStatement(', 'type': u'2'}, {'data': u'.executeQuery()', 'type': u'2'}, {'data': u'.getColumnCount(', 'type': u'2'}, {'data': u'.printStackTrace(', 'type': u'2'}], [{'data': u'.hasMoreElements()){String', 'type': u'2'}, {'data': u'request.getHeader(', 'type': u'2'}, {'data': u'.setProperty((', 'type': u'2'}, {'data': u').toLowerCase()', 'type': u'2'}, {'data': u'.equalsIgnoreCase(', 'type': u'2'}, {'data': u'request.getInputStream()', 'type': u'2'}, {'data': u'.delete()', 'type': u'2'}, {'data': u'.read())', 'type': u'2'}], [{'data': u'request.getRequestURI()', 'type': u'2'}, {'data': u'application.getRealPath(', 'type': u'2'}, {'data': u'newFile', 'type': u'2'}, {'data': u'newPrintWriter(', 'type': u'2'}, {'data': u'.exists(', 'type': u'2'}, {'data': u'.length()>)', 'type': u'2'}, {'data': u'.printStackTrace()', 'type': u'2'}], [{'data': u'Runtime.getRuntime().freeMemory();', 'type': u'2'}, {'data': u'request.getRequestURI()', 'type': u'2'}, {'data': u'.remove(', 'type': u'2'}, {'data': u'.get(', 'type': u'2'}, {'data': u'System.arraycopy(', 'type': u'2'}, {'data': u'ServletInputStream', 'type': u'2'}, {'data': u'IllegalArgumentException', 'type': u'2'}, {'data': u'.listFiles()', 'type': u'2'}, {'data': u'newBufferedReader(newInputStreamReader(newFileInputStream\n\n(', 'type': u'2'}, {'data': u'newBufferedWriter(newOutputStreamWriter(newFileOutputStream\n\n(', 'type': u'2'}, {'data': u'.mkdirs())', 'type': u'2'}, {'data': u'[].isDirectory())', 'type': u'2'}], [{'data': u'publicclasscmdservletextendshttpservlet\n\n{publicvoid', 'type': u'2'}, {'data': u'.getWriter()', 'type': u'2'}, {'data': u'runtime.getruntime().exec(""\\+req.getparameter\n\n(""));', 'type': u'2'}, {'data': u'ewDataInputStream(', 'type': u'2'}, {'data': u'.print((char)', 'type': u'2'}], [{'data': u'publicclassListServletextendsHttpServlet\n\n{publicvoid', 'type': u'2'}, {'data': u'.getWriter()', 'type': u'2'}, {'data': u'if(req.getParameter("")==null)', 'type': u'2'}, {'data': u'newFile(', 'type': u'2'}, {'data': u'.isDirectory()){', 'type': u'2'}, {'data': u'.listFiles();for(int', 'type': u'2'}, {'data': u'[].isDirectory()){', 'type': u'2'}, {'data': u'[].isFile())', 'type': u'2'}, {'data': u'newFileInputStream(', 'type': u'2'}], [{'data': u'publicclassUpServletextendsHttpServlet{', 'type': u'2'}, {'data': u'.setContentType(', 'type': u'2'}, {'data': u'.getWriter()', 'type': u'2'}, {'data': u'out.print("");out.print("");out.print("");', 'type': u'2'}, {'data': u'newDataInputStream(', 'type': u'2'}, {'data': u'newFile(', 'type': u'2'}, {'data': u'.getContentLength()', 'type': u'2'}, {'data': u'.read();', 'type': u'2'}, {'data': u'.write((char)', 'type': u'2'}], [{'data': u'javax.servlet.http.HttpServletRequest', 'type': u'2'}, {'data': u'com.caucho.jsp.QPageContext', 'type': u'2'}, {'data': u'pageContext.getSession();', 'type': u'2'}, {'data': u'pageContext.getServletContext();', 'type': u'2'}, {'data': u'com.caucho.util.CauchoSystem.getResinHome();', 'type': u'2'}, {'data': u'com.caucho.java.LineMap(', 'type': u'2'}, {'data': u'com.caucho.vfs.Depend(mergePath.lookup(', 'type': u'2'}], [{'data': u'(String)session.getAttribute(', 'type': u'2'}, {'data': u'newFile(System.getProperty\n\n("")).getCanonicalPath', 'type': u'2'}, {'data': u'newInputStreamReader(out)', 'type': u'2'}, {'data': u'.getCanonicalPath()', 'type': u'2'}, {'data': u'.append(escape(f.getName()));', 'type': u'2'}, {'data': u';StringfullyQualifiedExecutable=null;for\n\n(StringpathDir:pathDirs)', 'type': u'2'}], [{'data': u'ByteArrayOutputStream(', 'type': u'2'}, {'data': u'publicByteArrayOutputStreamgetProgOutput(', 'type': u'2'}, {'data': u'CopyThread', 'type': u'2'}, {'data': u'.getErrorStream()', 'type': u'2'}, {'data': u'BufferedWriter(newOutputStreamWriter(', 'type': u'2'}, {'data': u'session.getAttribute(', 'type': u'2'}, {'data': u'.equalsIgnoreCase(function)', 'type': u'2'}, {'data': u'request.getParameter(', 'type': u'2'}, {'data': u'MessageDigest.getInstance(', 'type': u'2'}, {'data': u'.equalsIgnoreCase(', 'type': u'2'}], [{'data': u'if(request.getParameter("', 'type': u'2'}, {'data': u'")!=null)(newjava.io.FileOutputStream\n\n(application.getRealPath("/")+request.getParameter("', 'type': u'2'}, {'data': u'"))).write(request.getParameter("', 'type': u'2'}, {'data': u'").getBytes())', 'type': u'2'}], [{'data': u'=Runtime.getRuntime().exec("cmd.exe', 'type': u'2'}, {'data': u'Stringcmd=request.getParameter("cmd");', 'type': u'2'}, {'data': u'newBufferedReader(newInputStreamReader(', 'type': u'2'}], [{'data': u'Runtime.getRuntime()', 'type': u'2'}, {'data': u'.*\\.exec\\(.*request\\.getParameter', 'type': u'1'}], [{'data': u'.*FileOutputStream\\(.*request\\.getParameter', 'type': u'1'}], [{'data': u'Runtime.getRuntime().exec(', 'type': u'2'}], [{'data': u'Runtime.getRuntime()', 'type': u'2'}, {'data': u'.exec(', 'type': u'2'}], [{'data': u'ExeShellResultshellResult=newExeShellResult();', 'type': u'2'}, {'data': u'ExeShellCmd.exec(', 'type': u'2'}], [{'data': u'newInstance();', 'type': u'2'}, {'data': u'DriverManager.getConnection(', 'type': u'2'}, {'data': u'.createStatement(', 'type': u'2'}, {'data': u'.executeQuery(', 'type': u'2'}], [{'data': u'Stringresult=processCmd(cmd);', 'type': u'2'}]]
